{"version":3,"sources":["../src/LayerStore.js"],"names":["LayerStore","store","displaying","layers","_mountPointsubscriptions","_layerSubscriptions","show","bind","hide","register","updateFn","unregister","id","layerFn","mountPointId","groups","defaultArgs","args","fn","length","setArgs","push","indexOf","splice"],"mappings":";;AAEqBA,U;;AAEnB,wBAAe;AACb,SAAKC,KAAL,GAAa;AACXC,kBAAY,EADD;AAEXC,cAAQ,EAFG,EAAb;;AAIA,SAAKC,wBAAL,GAAgC,EAAhC;AACA,SAAKC,mBAAL,GAA2B,EAA3B;AACA,SAAKC,IAAL,GAAY,KAAKA,IAAL,CAAUC,IAAV,CAAe,IAAf,CAAZ;AACA,SAAKC,IAAL,GAAY,KAAKA,IAAL,CAAUD,IAAV,CAAe,IAAf,CAAZ;AACA,SAAKE,QAAL,GAAgB,KAAKA,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKG,QAAL,GAAgB,KAAKA,QAAL,CAAcH,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKI,UAAL,GAAkB,KAAKA,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAlB;AACD,G;;AAESK,M,EAAQC,O,EAAiG,KAA/EC,YAA+E,uEAA5D,IAA4D,KAAtDC,MAAsD,uEAAlC,EAAkC,KAA9BC,WAA8B,uEAAJ,EAAI;AACjH,WAAKf,KAAL,CAAWE,MAAX,CAAkBS,EAAlB,IAAwB,EAAEC,gBAAF,EAAWE,cAAX,EAAmBD,0BAAnB,EAAiCG,MAAMD,WAAvC,EAAoDA,wBAApD,EAAxB;AACD,K;;AAESJ,M,EAAQC,O,EAAkB;AAClC,WAAKZ,KAAL,CAAWE,MAAX,CAAkBS,EAAlB,EAAsBM,EAAtB,GAA2BL,OAA3B;AACD,K;;AAEUD,M,EAAQ;AACjB,aAAO,KAAKX,KAAL,CAAWE,MAAX,CAAkBS,EAAlB,CAAP;AACD,K;;AAEOA,M,EAA+B,KAAvBK,IAAuB,uEAAJ,EAAI;AACrC,UAAIA,KAAKE,MAAT,EAAiB;AACf,aAAKlB,KAAL,CAAWE,MAAX,CAAkBS,EAAlB,EAAsBK,IAAtB,GAA6BA,IAA7B;AACD,OAFD,MAEO;AACL,aAAKhB,KAAL,CAAWE,MAAX,CAAkBS,EAAlB,EAAsBK,IAAtB,GAA6B,KAAKhB,KAAL,CAAWE,MAAX,CAAkBS,EAAlB,EAAsBI,WAAnD;AACD;AACF,K;;AAEKJ,M,EAAQK,I,EAAkB;AAC9B,WAAKG,OAAL,CAAaR,EAAb,EAAiBK,IAAjB;AACA,WAAKT,IAAL,CAAUI,EAAV;AACA,WAAKX,KAAL,CAAWC,UAAX,CAAsBmB,IAAtB,CAA2BT,EAA3B;AACD,K;;AAEKA,M,EAAQ;AACJV,gBADI,GACW,KAAKD,KADhB,CACJC,UADI;AAEZ,UAAI,CAAC,CAAD,KAAOA,WAAWoB,OAAX,CAAmBV,EAAnB,CAAX,EAAmC;AACjCV,mBAAWqB,MAAX,CAAkBrB,WAAWoB,OAAX,CAAmBV,EAAnB,CAAlB,EAA0C,CAA1C;AACD;AACF,K;;AAEgBA,M,EAAQM,E,EAAc;AACrC,WAAKb,mBAAL,CAAyBO,EAAzB,IAA+BM,EAA/B;AACA,aAAO,YAAM;AACX,eAAO,MAAKb,mBAAL,CAAyBO,EAAzB,CAAP;AACD,OAFD;AAGD,K;;AAEWA,M,EAAQM,E,EAAc;AAChC,UAAI,KAAKb,mBAAL,CAAyBO,EAAzB,CAAJ,EAAkC;AAChC,aAAKP,mBAAL,CAAyBO,EAAzB;AACD;AACF,K;;AAEqBA,M,EAAQM,E,EAAc;AAC1C,WAAKd,wBAAL,CAA8BQ,EAA9B,IAAoCM,EAApC;AACA,aAAO,YAAM;AACX,eAAO,OAAKd,wBAAL,CAA8BQ,EAA9B,CAAP;AACD,OAFD;AAGD,K;;AAEgBE,gB,EAAkB;AACjC,UAAI,KAAKV,wBAAL,CAA8BU,YAA9B,CAAJ,EAAiD;AAC/C,aAAKV,wBAAL,CAA8BU,YAA9B;AACD;AACF,K,6CAzEkBd,U","file":"LayerStore.js","sourcesContent":["import type { ID, LayerFn } from './types'\n\nexport default class LayerStore {\n\n  constructor () {\n    this.store = {\n      displaying: [],\n      layers: {},\n    };\n    this._mountPointsubscriptions = {};\n    this._layerSubscriptions = {};\n    this.show = this.show.bind(this);\n    this.hide = this.hide.bind(this);\n    this.register = this.register.bind(this);\n    this.updateFn = this.updateFn.bind(this);\n    this.unregister = this.unregister.bind(this);\n  }\n\n  register (id: ID, layerFn: LayerFn, mountPointId: ID = null, groups: Array<ID> = [], defaultArgs: Array<any> = []) {\n    this.store.layers[id] = { layerFn, groups, mountPointId, args: defaultArgs, defaultArgs };\n  }\n\n  updateFn (id: ID, layerFn: LayerFn) {\n    this.store.layers[id].fn = layerFn;\n  }\n\n  unregister(id: ID) {\n    delete this.store.layers[id];\n  }\n\n  setArgs(id: ID, args: Array<any> = []) {\n    if (args.length) {\n      this.store.layers[id].args = args;\n    } else {\n      this.store.layers[id].args = this.store.layers[id].defaultArgs;\n    }\n  }\n\n  show (id: ID, args: Array<any>) {\n    this.setArgs(id, args);\n    this.hide(id);\n    this.store.displaying.push(id);\n  }\n\n  hide (id: ID) {\n    const { displaying } = this.store;\n    if (-1 !== displaying.indexOf(id)) {\n      displaying.splice(displaying.indexOf(id), 1);\n    }\n  }\n\n  subscribeToLayer(id: ID, fn: Function) {\n    this._layerSubscriptions[id] = fn;\n    return () => {\n      delete this._layerSubscriptions[id];\n    }\n  }\n\n  notifyLayer(id: ID, fn: Function) {\n    if (this._layerSubscriptions[id]) {\n      this._layerSubscriptions[id]()\n    }\n  }\n\n  subscribeToMountPoint(id: ID, fn: Function) {\n    this._mountPointsubscriptions[id] = fn;\n    return () => {\n      delete this._mountPointsubscriptions[id];\n    }\n  }\n\n  notifyMountPoint(mountPointId: ID) {\n    if (this._mountPointsubscriptions[mountPointId]) {\n      this._mountPointsubscriptions[mountPointId]()\n    }\n  }\n}\n"]}